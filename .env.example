# MSSQL to PostgreSQL Pipeline - Environment Configuration
#
# This file configures:
#   1. Database connections (AIRFLOW_CONN_* variables)
#   2. Resource settings (memory, CPUs) for Docker containers
#   3. Credentials for local Docker database containers
#
# QUICK START:
#   1. cp .env.example .env
#   2. Edit database connections below for your environment
#   3. Choose resource preset for your machine's RAM
#   4. Run: docker-compose up -d

# =============================================================================
# DATABASE CONNECTIONS
# =============================================================================
# Airflow loads connections from AIRFLOW_CONN_* environment variables.
# URL-encode special characters in passwords (e.g., @ → %40, # → %23)

# SQL Server Source (uses generic:// type for pyodbc)
# With SQL Server authentication:
AIRFLOW_CONN_MSSQL_SOURCE=generic://sa:YourStrong%40Passw0rd@mssql-server:1433/StackOverflow2010
# With Windows/Kerberos authentication (no credentials):
# AIRFLOW_CONN_MSSQL_SOURCE=generic://myserver.company.com:1433/MyDatabase

# PostgreSQL Target
AIRFLOW_CONN_POSTGRES_TARGET=postgresql://postgres:PostgresPassword123@postgres-target:5432/stackoverflow
# Remote database example:
# AIRFLOW_CONN_POSTGRES_TARGET=postgresql://user:pass@mydb.abc123.rds.amazonaws.com:5432/mydb

# =============================================================================
# PRESET: 16GB RAM (conservative)
# =============================================================================
# MSSQL_MEM_LIMIT=2g
# MSSQL_MEM_RESERVATION=1g
# MSSQL_CPUS=4
# PG_MEM_LIMIT=1536m
# PG_MEM_RESERVATION=768m
# PG_CPUS=3
# PG_SHARED_BUFFERS=256MB
# PG_EFFECTIVE_CACHE_SIZE=512MB
# PG_MAINTENANCE_WORK_MEM=64MB
# MAX_PARTITIONS=4

# =============================================================================
# PRESET: 32GB RAM (default)
# =============================================================================
MSSQL_MEM_LIMIT=4g
MSSQL_MEM_RESERVATION=2g
MSSQL_CPUS=4

PG_MEM_LIMIT=3g
PG_MEM_RESERVATION=1536m
PG_CPUS=4
PG_SHARED_BUFFERS=512MB
PG_EFFECTIVE_CACHE_SIZE=1536MB
PG_MAINTENANCE_WORK_MEM=256MB

MAX_PARTITIONS=8
DEFAULT_CHUNK_SIZE=200000

# =============================================================================
# PRESET: 64GB+ RAM (high performance)
# =============================================================================
# MSSQL_MEM_LIMIT=8g
# MSSQL_MEM_RESERVATION=4g
# MSSQL_CPUS=6
# PG_MEM_LIMIT=6g
# PG_MEM_RESERVATION=3g
# PG_CPUS=6
# PG_SHARED_BUFFERS=1GB
# PG_EFFECTIVE_CACHE_SIZE=3GB
# PG_MAINTENANCE_WORK_MEM=512MB
# MAX_PARTITIONS=12

# =============================================================================
# LOCAL DOCKER CONTAINER CREDENTIALS
# =============================================================================
# These are used by docker-compose.yml for local development containers.
# For remote databases, update the AIRFLOW_CONN_* variables above.

# SQL Server container credentials
MSSQL_PASSWORD=YourStrong@Passw0rd

# PostgreSQL container credentials
PG_USER=postgres
PG_PASSWORD=PostgresPassword123
PG_DATABASE=stackoverflow

# =============================================================================
# NOTIFICATION CONFIGURATION
# =============================================================================
# Enable/disable notifications (true/false)
NOTIFICATION_ENABLED=false

# Notification channels: comma-separated list of 'email' and/or 'slack'
NOTIFICATION_CHANNELS=email,slack

# Email configuration (SMTP)
# For Gmail: Use an App Password (https://support.google.com/accounts/answer/185833)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password-here
NOTIFICATION_EMAIL_FROM=your-email@gmail.com
NOTIFICATION_EMAIL_TO=recipient1@example.com,recipient2@example.com

# Slack configuration
# Create webhook at https://api.slack.com/messaging/webhooks
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL
